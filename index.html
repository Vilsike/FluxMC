<!-- index.html -->

<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="description" content="Crownfall. A political medieval SMP built around player-run Houses, Influence, diplomacy, and declared wars. IP: play.crownfall.gg. Version: 1.21.11" />
  <title>Crownfall</title>

  <link rel="stylesheet" href="css/styles.css?v=8" />
</head>

<body>
  <canvas id="embers" aria-hidden="true"></canvas>
  <div class="bg-vignette" aria-hidden="true"></div>
  <div class="frame-vignette" aria-hidden="true"></div>

  <header class="topbar" role="banner">
    <div class="topbar-inner">
      <a class="topbar-brand" href="/" aria-label="Crownfall home">
        <img src="assets/logo.png" alt="Crownfall logo" />
        <span class="topbar-name">Crownfall</span>
      </a>

      <nav class="topbar-nav" aria-label="Primary">
        <a class="topbar-link" href="#about">About</a>
        <a class="topbar-link" href="#pillars">Pillars</a>
        <a class="topbar-link" href="#ironvale">Ironvale</a>

        <span class="topbar-sep" aria-hidden="true"></span>

        <button class="topbar-btn" type="button" id="copyIpBtn" aria-label="Copy server IP">
          Copy IP
        </button>

        <a class="topbar-btn is-primary" href="/discord" target="_blank" rel="noreferrer">
          Discord
        </a>
      </nav>
    </div>
  </header>

  <main class="wrap" role="main">
    <section class="hero" aria-label="Crownfall overview">
      <div class="panel">
        <div class="panel-inner">
          <div class="panel-watermark" aria-hidden="true"></div>
          <div class="panel-filigree" aria-hidden="true"></div>
          <div class="panel-tatter" aria-hidden="true"></div>
          <div class="panel-fibers" aria-hidden="true"></div>
          <div class="panel-specks" aria-hidden="true"></div>

          <div class="panel-content">
            <div class="panel-crest" aria-hidden="true">
              <img src="assets/logo.png" alt="" />
            </div>

            <div class="phase-badge" aria-label="Development phase">
              <img src="assets/badge_development.png" alt="In Development" />
            </div>

            <h1 class="title">Crownfall</h1>

            <p class="tagline">
              A political medieval SMP where player-run Houses rise through Influence, diplomacy, trade, culture, and declared war.
            </p>

            <div class="actions" aria-label="Primary actions">
              <a class="cta" href="/discord" target="_blank" rel="noreferrer">Join the Discord</a>
              <button class="cta ghost" type="button" id="copyIpBtn2">Copy IP</button>
            </div>

            <div class="pillrow" aria-label="Server details">
              <div class="pill">Version: <strong>1.21.11</strong></div>
              <div class="pill">Java + Bedrock</div>
              <div class="pill">Capital: <strong>Ironvale</strong></div>
            </div>

            <div class="grid">
              <section class="section" id="about">
                <h2>What is Crownfall</h2>
                <p>
                  Crownfall is a realm-scale survival experience built around politics and player agency. You form a House, claim territory,
                  build your seat of power, and compete for Influence through meaningful systems rather than constant raiding.
                </p>
              </section>

              <section class="section" id="pillars">
                <h2>Pillars of the Realm</h2>
                <p>
                  <strong>Houses, not factions.</strong> Your identity is your House, your banner, your allies, and your reputation.
                  <br />
                  <strong>Influence.</strong> A realm-wide measure of power tied to governance, status, and major decisions.
                  <br />
                  <strong>Diplomacy and economy.</strong> Trade routes, markets, taxes, and negotiated agreements matter.
                  <br />
                  <strong>War is opt-in.</strong> Formal declarations, scheduled conflicts, and objective-based outcomes.
                </p>
              </section>

              <section class="section" id="ironvale">
                <h2>Ironvale</h2>
                <p>
                  Ironvale is the capital city and political hub. It is where Houses meet, treaties are signed, markets flourish,
                  and council business is handled. It is spawn, but it is also the stage.
                </p>
              </section>

              <section class="section">
                <h2>Join the Council</h2>
                <p>
                  We are actively building Crownfall. Join the Discord to follow dev updates, see system previews, and get early access when testing opens.
                </p>
              </section>
            </div>
          </div>
        </div>
      </div>
    </section>
  </main>

  <div id="toast" class="toast" role="status" aria-live="polite"></div>

  <script src="js/embers.js?v=5"></script>

  <script>
    (function () {
      const ip = "play.crownfall.gg";

      function showToast(msg) {
        const t = document.getElementById("toast");
        if (!t) return;
        t.textContent = msg;
        t.classList.add("show");
        clearTimeout(window.__toastTimer);
        window.__toastTimer = setTimeout(() => t.classList.remove("show"), 1400);
      }

      function copy(text) {
        if (navigator.clipboard && navigator.clipboard.writeText) {
          return navigator.clipboard.writeText(text);
        }
        const ta = document.createElement("textarea");
        ta.value = text;
        document.body.appendChild(ta);
        ta.select();
        document.execCommand("copy");
        document.body.removeChild(ta);
        return Promise.resolve();
      }

      async function handleCopy() {
        try {
          await copy(ip);
          showToast("Copied: " + ip);
        } catch (e) {
          showToast("Copy failed");
        }
      }

      const btn1 = document.getElementById("copyIpBtn");
      const btn2 = document.getElementById("copyIpBtn2");
      if (btn1) btn1.addEventListener("click", handleCopy);
      if (btn2) btn2.addEventListener("click", handleCopy);

      const links = Array.from(document.querySelectorAll(".topbar-nav a.topbar-link"));
      const sections = links
        .map(a => document.querySelector(a.getAttribute("href")))
        .filter(Boolean);

      if (sections.length) {
        const obs = new IntersectionObserver((entries) => {
          const visible = entries
            .filter(e => e.isIntersecting)
            .sort((a, b) => b.intersectionRatio - a.intersectionRatio)[0];

          if (!visible) return;

          links.forEach(a => a.classList.remove("is-active"));
          const active = links.find(a => a.getAttribute("href") === "#" + visible.target.id);
          if (active) active.classList.add("is-active");
        }, {
          root: null,
          rootMargin: "-20% 0px -70% 0px",
          threshold: [0.15, 0.25, 0.35]
        });

        sections.forEach(s => obs.observe(s));
      }
    })();
  </script>
</body>
</html>
